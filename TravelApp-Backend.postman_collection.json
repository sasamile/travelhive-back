{
	"info": {
		"_postman_id": "travelapp-backend-collection",
		"name": "Travel App Backend",
		"description": "Colecci√≥n de endpoints para Travel App Backend - NestJS + Better Auth + Prisma",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "üîê Autenticaci√≥n (Better Auth)",
			"item": [
				{
					"name": "Registrar Usuario",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"usuario@example.com\",\n  \"password\": \"password123\",\n  \"name\": \"Juan P√©rez\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/sign-up/email",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"sign-up",
								"email"
							]
						},
						"description": "Registra un nuevo usuario con email y contrase√±a"
					},
					"response": []
				},
				{
					"name": "Iniciar Sesi√≥n",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Las cookies se guardan autom√°ticamente en Postman",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"usuario@example.com\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/sign-in/email",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"sign-in",
								"email"
							]
						},
						"description": "Inicia sesi√≥n con email y contrase√±a. Las cookies de sesi√≥n se guardan autom√°ticamente."
					},
					"response": []
				},
				{
					"name": "Obtener Sesi√≥n Actual",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/auth/get-session",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"get-session"
							]
						},
						"description": "Obtiene la sesi√≥n actual del usuario autenticado"
					},
					"response": []
				},
				{
					"name": "Cerrar Sesi√≥n",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/auth/sign-out",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"sign-out"
							]
						},
						"description": "Cierra la sesi√≥n del usuario actual"
					},
					"response": []
				},
				{
					"name": "Verificar Email",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"token\": \"verification-token\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/verify-email",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"verify-email"
							]
						},
						"description": "Verifica el email del usuario con un token"
					},
					"response": []
				}
			],
			"description": "Endpoints de autenticaci√≥n proporcionados por Better Auth"
		},
		{
			"name": "üë§ Autenticaci√≥n Personalizada",
			"item": [
				{
					"name": "Obtener Perfil",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/auth/me",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"me"
							]
						},
						"description": "Obtiene el perfil del usuario autenticado. Requiere cookie de sesi√≥n."
					},
					"response": []
				},
				{
					"name": "Obtener Sesi√≥n Completa",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/auth/session",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"session"
							]
						},
						"description": "Obtiene la sesi√≥n completa del usuario. Requiere cookie de sesi√≥n."
					},
					"response": []
				},
				{
					"name": "Ruta P√∫blica",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/auth/public",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"public"
							]
						},
						"description": "Ruta p√∫blica que no requiere autenticaci√≥n. √ötil para verificar que el servidor est√° funcionando. Tambi√©n funciona como health check endpoint."
					},
					"response": []
				}
			],
			"description": "Endpoints personalizados de autenticaci√≥n"
		},
		{
			"name": "üè¢ Agencias",
			"item": [
				{
					"name": "Registrar Usuario-Agencia",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"emailUser\": \"agencia@example.com\",\n  \"nameUser\": \"Juan P√©rez\",\n  \"password\": \"password123\",\n  \"dniUser\": \"12345678\",\n  \"phoneUser\": \"+57 300 123 4567\",\n  \"nameAgency\": \"Agencia de Viajes XYZ\",\n  \"email\": \"contacto@agenciaxyz.com\",\n  \"phone\": \"+57 1 234 5678\",\n  \"nit\": \"900123456-7\",\n  \"rntNumber\": \"RNT-12345\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/agencies/register",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"agencies",
								"register"
							]
						},
						"description": "Crea un nuevo usuario (persona natural) que presta experiencias y su agencia asociada. La agencia queda en estado PENDING hasta aprobaci√≥n."
					},
					"response": []
				},
				{
					"name": "Crear Trip (Experiencia)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"idAgency\": 1,\n  \"idCity\": 1,\n  \"title\": \"Tour por la Ciudad Perdida\",\n  \"description\": \"Una experiencia √∫nica por las ruinas arqueol√≥gicas\",\n  \"category\": \"Aventura\",\n  \"vibe\": \"Ecoturismo\",\n  \"durationDays\": 4,\n  \"durationNights\": 3,\n  \"coverImage\": \"https://example.com/cover.jpg\",\n  \"status\": \"DRAFT\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/agencies/:agencyId/trips",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"agencies",
								":agencyId",
								"trips"
							],
							"variable": [
								{
									"key": "agencyId",
									"value": "1",
									"description": "ID de la agencia"
								}
							]
						},
						"description": "Crea un nuevo trip (experiencia) para la agencia. Requiere autenticaci√≥n y rol admin o editor."
					},
					"response": []
				},
				{
					"name": "Listar Trips de Agencia",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/agencies/:agencyId/trips",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"agencies",
								":agencyId",
								"trips"
							],
							"variable": [
								{
									"key": "agencyId",
									"value": "1",
									"description": "ID de la agencia"
								}
							]
						},
						"description": "Lista todos los trips de una agencia. Requiere autenticaci√≥n y pertenecer a la agencia."
					},
					"response": []
				},
				{
					"name": "Actualizar Trip",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"Tour por la Ciudad Perdida - Actualizado\",\n  \"description\": \"Nueva descripci√≥n\",\n  \"status\": \"PUBLISHED\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/agencies/:agencyId/trips/:tripId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"agencies",
								":agencyId",
								"trips",
								":tripId"
							],
							"variable": [
								{
									"key": "agencyId",
									"value": "1",
									"description": "ID de la agencia"
								},
								{
									"key": "tripId",
									"value": "1",
									"description": "ID del trip"
								}
							]
						},
						"description": "Actualiza un trip existente. Requiere autenticaci√≥n y rol admin o editor."
					},
					"response": []
				},
				{
					"name": "Eliminar Trip",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/agencies/:agencyId/trips/:tripId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"agencies",
								":agencyId",
								"trips",
								":tripId"
							],
							"variable": [
								{
									"key": "agencyId",
									"value": "1",
									"description": "ID de la agencia"
								},
								{
									"key": "tripId",
									"value": "1",
									"description": "ID del trip"
								}
							]
						},
						"description": "Elimina un trip. Requiere autenticaci√≥n y rol admin."
					},
					"response": []
				},
				{
					"name": "Crear Expedici√≥n",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"idTrip\": 1,\n  \"startDate\": \"2026-03-15T00:00:00.000Z\",\n  \"endDate\": \"2026-03-18T00:00:00.000Z\",\n  \"capacityTotal\": 20,\n  \"capacityAvailable\": 20,\n  \"priceAdult\": 500000,\n  \"priceChild\": 300000,\n  \"currency\": \"COP\",\n  \"status\": \"AVAILABLE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/agencies/trips/:tripId/expeditions",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"agencies",
								"trips",
								":tripId",
								"expeditions"
							],
							"variable": [
								{
									"key": "tripId",
									"value": "1",
									"description": "ID del trip"
								}
							]
						},
						"description": "Crea una nueva expedici√≥n (instancia de trip con fechas). Requiere autenticaci√≥n y rol admin o editor."
					},
					"response": []
				},
				{
					"name": "Listar Expediciones de Trip",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/agencies/trips/:tripId/expeditions",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"agencies",
								"trips",
								":tripId",
								"expeditions"
							],
							"variable": [
								{
									"key": "tripId",
									"value": "1",
									"description": "ID del trip"
								}
							]
						},
						"description": "Lista todas las expediciones de un trip. Requiere autenticaci√≥n y pertenecer a la agencia del trip."
					},
					"response": []
				}
			],
			"description": "Endpoints para gestionar agencias, trips y expediciones"
		},
		{
			"name": "üë®‚Äçüíº Administraci√≥n",
			"item": [
				{
					"name": "Listar Agencias Pendientes",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/admin/agencies/pending",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"admin",
								"agencies",
								"pending"
							]
						},
						"description": "Lista todas las agencias que est√°n pendientes de aprobaci√≥n. Requiere autenticaci√≥n."
					},
					"response": []
				},
				{
					"name": "Aprobar Agencia",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/admin/agencies/:agencyId/approve",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"admin",
								"agencies",
								":agencyId",
								"approve"
							],
							"variable": [
								{
									"key": "agencyId",
									"value": "1",
									"description": "ID de la agencia a aprobar"
								}
							]
						},
						"description": "Aprueba una agencia pendiente. Requiere autenticaci√≥n."
					},
					"response": []
				},
				{
					"name": "Rechazar Agencia",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"rejectionReason\": \"Documentaci√≥n incompleta\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/admin/agencies/:agencyId/reject",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"admin",
								"agencies",
								":agencyId",
								"reject"
							],
							"variable": [
								{
									"key": "agencyId",
									"value": "1",
									"description": "ID de la agencia a rechazar"
								}
							]
						},
						"description": "Rechaza una agencia pendiente con una raz√≥n. Requiere autenticaci√≥n."
					},
					"response": []
				}
			],
			"description": "Endpoints de administraci√≥n para gestionar agencias"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:3000",
			"type": "string"
		}
	]
}
